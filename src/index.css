@import 'tailwindcss';
@import "tw-animate-css";

@layer base {
  body {
    font-family: 'Inter', sans-serif;
    overflow-x: hidden; /* Prevent horizontal scroll */
  }
  
  html {
    scroll-behavior: smooth;
  }
  
  * {
    @apply border-border
  }

  /* Force Sonner toast descriptions to use foreground color */
  [data-sonner-toast] [data-description] {
    color: hsl(var(--foreground)) !important;
    opacity: 0.9;
  }
}

@layer utilities {
  /* Neumorphic design utilities */
  .neomorph-raised {
    box-shadow: 
      8px 8px 16px var(--shadow-dark),
      -8px -8px 16px var(--shadow-light);
  }
  
  .neomorph-inset {
    box-shadow: 
      inset 4px 4px 8px var(--shadow-dark),
      inset -4px -4px 8px var(--shadow-light);
  }
  
  .neomorph-flat {
    box-shadow: 
      4px 4px 8px var(--shadow-dark),
      -4px -4px 8px var(--shadow-light);
  }
  
  .neomorph-button {
    box-shadow: 
      6px 6px 12px var(--shadow-dark),
      -6px -6px 12px var(--shadow-light);
    transition: all 0.2s ease;
  }
  
  .neomorph-button:hover {
    box-shadow: 
      4px 4px 8px var(--shadow-dark),
      -4px -4px 8px var(--shadow-light);
  }
  
  .neomorph-hover {
    transition: all 0.2s ease;
  }
  
  .neomorph-hover:hover {
    box-shadow: 
      6px 6px 12px var(--shadow-dark),
      -6px -6px 12px var(--shadow-light);
  }
  
  .neomorph-pressed {
    box-shadow: 
      inset 2px 2px 4px var(--shadow-dark),
      inset -2px -2px 4px var(--shadow-light),
      8px 8px 16px var(--shadow-dark),
      -8px -8px 16px var(--shadow-light);
  }
  
  /* Enhanced touch and drag interactions */
  .touch-manipulation {
    touch-action: manipulation;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
  }
  
  /* Improved drag handle visibility */
  .drag-handle {
    min-height: 44px;
    min-width: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Custom scrollbar for chapter list */
  .chapter-list::-webkit-scrollbar {
    width: 6px;
  }
  
  .chapter-list::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .chapter-list::-webkit-scrollbar-thumb {
    background: hsl(var(--muted-foreground) / 0.3);
    border-radius: 3px;
  }
  
  .chapter-list::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--muted-foreground) / 0.5);
  }
  
  .neomorph-button:active {
    box-shadow: 
      inset 2px 2px 4px var(--shadow-dark),
      inset -2px -2px 4px var(--shadow-light);
  }

  /* Mobile-specific adjustments */
  @media (max-width: 1024px) {
    /* Enable momentum scrolling on iOS */
    * {
      -webkit-overflow-scrolling: touch;
    }
    
    /* iOS scrolling fix */
    .ios-scroll {
      -webkit-overflow-scrolling: touch;
      overflow: auto;
    }
    
    .neomorph-raised {
      box-shadow: 
        6px 6px 12px var(--shadow-dark),
        -6px -6px 12px var(--shadow-light);
    }
    
    .neomorph-inset {
      box-shadow: 
        inset 3px 3px 6px var(--shadow-dark),
        inset -3px -3px 6px var(--shadow-light);
    }
    
    .neomorph-flat {
      box-shadow: 
        3px 3px 6px var(--shadow-dark),
        -3px -3px 6px var(--shadow-light);
    }
    
    .neomorph-button {
      box-shadow: 
        4px 4px 8px var(--shadow-dark),
        -4px -4px 8px var(--shadow-light);
    }
    
    .neomorph-button:hover {
      box-shadow: 
        3px 3px 6px var(--shadow-dark),
        -3px -3px 6px var(--shadow-light);
    }
    
    .neomorph-button:active {
      box-shadow: 
        inset 2px 2px 4px var(--shadow-dark),
        inset -2px -2px 4px var(--shadow-light);
    }
  }

  /* Line clamp utilities */
  .line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
    line-clamp: 1;
  }
  
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    line-clamp: 2;
  }
}

:root {
  /*
   * Base colors that define the core visual identity - Neumorphic theme
   * --background: Main page background with subtle warm gray
   * --foreground: Primary text color to use on the background
   */
  --background: oklch(0.94 0.008 220);
  --foreground: oklch(0.20 0.02 220);

  --card: oklch(0.94 0.008 220);
  --card-foreground: oklch(0.20 0.02 220);
  --popover: oklch(0.95 0.008 220);
  --popover-foreground: oklch(0.20 0.02 220);

  /*
   * Action colors that represent interactive elements
   * --primary: Modern purple gradient feel
   * --secondary: Soft elevated feel
   * --accent: Vibrant accent for highlights
   * --destructive: Gentle red for warnings
   */
  --primary: oklch(0.55 0.20 280);
  --primary-foreground: oklch(0.98 0.005 280);
  --secondary: oklch(0.94 0.008 220);
  --secondary-foreground: oklch(0.25 0.02 220);
  --accent: oklch(0.70 0.18 340);
  --accent-foreground: oklch(0.98 0.005 340);
  --destructive: oklch(0.60 0.15 20);
  --destructive-foreground: oklch(0.98 0.005 20);

  /*
   * Supporting UI colors for neumorphic design
   * --muted: Slightly darker for recessed areas
   * --border: Subtle borders for definition
   * --input: Input field styling
   * --ring: Focus indicator with primary color
   */
  --muted: oklch(0.92 0.008 220);
  --muted-foreground: oklch(0.50 0.02 220);
  --border: oklch(0.88 0.008 220);
  --input: oklch(0.96 0.008 220);
  --ring: oklch(0.55 0.20 280);

  /*
   * Neumorphic shadow variables for elevated/inset effects
   */
  --shadow-light: oklch(0.98 0.005 220);
  --shadow-dark: oklch(0.85 0.015 220);

  /*
   * Border radius for modern, soft feel
   */
  --radius: 1rem;
}

/*
 * Map the CSS variables to Tailwind's theme system
 * This enables using classes like bg-primary, text-foreground, etc.
 */
@theme {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  /* Neumorphic shadow colors */
  --color-shadow-light: var(--shadow-light);
  --color-shadow-dark: var(--shadow-dark);

  /* Map radius variables to create a consistent rounding system */
  --radius-sm: calc(var(--radius) * 0.5);
  --radius-md: var(--radius);
  --radius-lg: calc(var(--radius) * 1.5);
  --radius-xl: calc(var(--radius) * 2);
  --radius-2xl: calc(var(--radius) * 3);
  --radius-full: 9999px;
}

/* Tiptap Editor Styles */
.ProseMirror {
  outline: none;
  min-height: 200px;
  padding: 1rem;
}

.ProseMirror p.is-editor-empty:first-child::before {
  color: hsl(var(--muted-foreground));
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
}

.ProseMirror h1 {
  font-size: 2em;
  font-weight: bold;
  margin-top: 0.67em;
  margin-bottom: 0.67em;
}

.ProseMirror h2 {
  font-size: 1.5em;
  font-weight: bold;
  margin-top: 0.83em;
  margin-bottom: 0.83em;
}

.ProseMirror h3 {
  font-size: 1.17em;
  font-weight: bold;
  margin-top: 1em;
  margin-bottom: 1em;
}

.ProseMirror p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
  line-height: 1.6;
}

.ProseMirror ul,
.ProseMirror ol {
  padding-left: 2em;
  margin: 0.5em 0;
}

.ProseMirror li {
  margin: 0.25em 0;
}

.ProseMirror strong {
  font-weight: bold;
}

.ProseMirror em {
  font-style: italic;
}

.ProseMirror u {
  text-decoration: underline;
}

.ProseMirror code {
  background-color: hsl(var(--muted));
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-family: monospace;
  font-size: 0.9em;
}

.ProseMirror pre {
  background-color: hsl(var(--muted));
  padding: 1em;
  border-radius: 6px;
  overflow-x: auto;
}

.ProseMirror blockquote {
  border-left: 3px solid hsl(var(--border));
  padding-left: 1em;
  margin-left: 0;
  font-style: italic;
  color: hsl(var(--muted-foreground));
}

/* Preview tab prose styling */
.prose {
  color: hsl(var(--foreground));
  max-width: 65ch;
}

.prose p {
  margin-bottom: 1.25em;
  line-height: 1.75;
}

.prose h1 {
  font-size: 2.25em;
  font-weight: 800;
  line-height: 1.1111;
  margin-top: 0;
  margin-bottom: 0.8888em;
}

.prose h2 {
  font-size: 1.5em;
  font-weight: 700;
  line-height: 1.3333;
  margin-top: 2em;
  margin-bottom: 1em;
}

.prose h3 {
  font-size: 1.25em;
  font-weight: 600;
  line-height: 1.6;
  margin-top: 1.6em;
  margin-bottom: 0.6em;
}

.prose strong {
  font-weight: 600;
  color: hsl(var(--foreground));
}

.prose em {
  font-style: italic;
}

.prose u {
  text-decoration: underline;
}

.prose ul, .prose ol {
  padding-left: 1.625em;
  margin-top: 1.25em;
  margin-bottom: 1.25em;
}

.prose li {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

.prose ul > li {
  padding-left: 0.375em;
}

.prose ol > li {
  padding-left: 0.375em;
}

/* Text alignment support */
.prose [style*="text-align: center"] {
  text-align: center;
}

.prose [style*="text-align: right"] {
  text-align: right;
}

.prose [style*="text-align: justify"] {
  text-align: justify;
}
